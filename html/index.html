<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>PiP - Process-in-Process: pip Overview of Process-in-Process (PiP)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PiP - Process-in-Process
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">pip Overview of Process-in-Process (PiP) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="overview"></a>
Overview</h1>
<p>PiP is a user-level library which allows a process to create sub-processes into the same virtual address space where the parent process runs. The parent process and sub-processes share the same address space, however, each process has its own variables. So, each process runs independently from the other process. If some or all processes agreed, then data own by a process can be accessed by the other processes.</p>
<p>Those processes share the same address space, just like pthreads, and each process has its own variables like a process. The parent process is called <em>PiP</em> <em>process</em> and sub-processes are called <em>PiP</em> <em>task</em> since it has the best of the both worlds of processes and pthreads.</p>
<p>PiP root can spawn one or more number of PiP tasks. The PiP root and PiP tasks shared the same address space. The executable of the PiP task must be compiled (with the "-fpie" compile option) and linked (with the "-pie" linker option) as PIE (Position Independent Executable).</p>
<p>When a PiP root or PiP task wants to be accessed the its own data by the other(s), firstly a memory region where the data to be accessed are located must be <em>exported</em>. Then the exported memory region is <em>imported</em> so that the exported and imported data can be accessed. The PiP library supports the functions to export and import the memory region to be accessible.</p>
<h1><a class="anchor" id="execution-mode"></a>
Execution mode</h1>
<p>There are several PiP implementation modes which can be selected at the runtime. These implementations can be categorized into two according to the behavior of PiP tasks,</p>
<ul>
<li><code>Pthread</code>, and</li>
<li><code>Process</code>.</li>
</ul>
<p>In the pthread mode, although each PiP task has its own variables unlike thread, PiP task behaves more like Pthread, having no PID, having the same file descriptor space, having the same signal delivery semantics as Pthread does, and so on.</p>
<p>In the process mode, PiP task behaves more like a process, having a PID, having an independent file descriptor space, having the same signal delivery semantics as Linux process does, and so on.</p>
<p>When the <code>PIP_MODE</code> environment variable set to "thread" then the PiP library runs based on the pthread mode, and it is set to "process" then it runs with the process mode. There are also two implementations in the <b>process</b> mode; "process:preload" and "process:pipclone" The former one must be with the <b>LD_PRELOAD</b> environment variable setting so that the <b>clone()</b> system call wrapper can work with. The latter one can only be specified with the PIP-patched glibc library (see below: <b>GLIBC</b> issues).</p>
<p>There several function provided by the PiP library to absorb the difference due to the execution mode</p>
<h1><a class="anchor" id="limitation"></a>
Limitation</h1>
<p>PiP allows PiP root and PiP tasks to share the data, so the function pointer can be passed to the others. However, jumping into the code owned by the other may not work properly for some reasons.</p>
<h1><a class="anchor" id="compile-and-link"></a>
Compile and Link User programs</h1>
<p>The PiP root ust be linked with the PiP library and libpthread. The programs able to run as a PiP task must be compiled with the "-fpie" compile option and the "-pie -rdynamic" linker options.</p>
<h1><a class="anchor" id="glibc-issues"></a>
GLIBC issues</h1>
<p>The PiP library is implemented at the user-level, i.e. no need of kernel patches nor kernel modules. Due to the novel usage of combining <code>dlmopn()</code> GLIBC function and <code>clone()</code> systemcall, there are some issues found in the GLIBC. To avoid this issues, PiP users may have the patched GLIBC provided by the PiP development team.</p>
<h1><a class="anchor" id="gdb-issue"></a>
GDB issue</h1>
<p>Currently gdb debugger only works with the PiP root. PiP-aware GDB will be provided soon.</p>
<h1><a class="anchor" id="author"></a>
Author</h1>
<p>Atsushi Hori (RIKEN, Japan) <a href="#" onclick="location.href='mai'+'lto:'+'aho'+'ri'+'@ri'+'ke'+'n.j'+'p'; return false;">ahori<span style="display: none;">.nosp@m.</span>@rik<span style="display: none;">.nosp@m.</span>en.jp</a> </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
