<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Process-in-Process: PiP Initialization/Finalization</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Process-in-Process
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">PiP Initialization/Finalization</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gad4e0db6c69792b3fa014e3310892a0eb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PiP-0-init-fin.html#gad4e0db6c69792b3fa014e3310892a0eb">pip_init</a> (int *pipidp, int *ntasks, void **root_expp, int opts)</td></tr>
<tr class="separator:gad4e0db6c69792b3fa014e3310892a0eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac4654282785abb9434ce81573fdf16ed"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__PiP-0-init-fin.html#gac4654282785abb9434ce81573fdf16ed">pip_fin</a> (void)</td></tr>
<tr class="separator:gac4654282785abb9434ce81573fdf16ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>


<h3><a class="anchor" id="pip-intialize-finalize"></a>PiP Initialization/Finalization</h3><div class="textblock"><dl class="section user"><dt>Description</dt><dd>PiP initialization/finalization functions </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gad4e0db6c69792b3fa014e3310892a0eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pip_init </td>
          <td>(</td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>pipidp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>ntasks</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void **&#160;</td>
          <td class="paramname"><em>root_expp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>opts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section user"><dt>Name</dt><dd>pip_init<a name="gad4e0db6c69792b3fa014e3310892a0eb_pip_init"></a></dd></dl>
<dl class="section user"><dt>Name</dt><dd>Initialize the PiP library</dd></dl>
<dl class="section user"><dt>Synopsis</dt><dd>#include &lt;<a class="el" href="pip_8h_source.html">pip.h</a>&gt; <br/>
int pip_init( int *pipidp, int *ntasks, void **root_expp, uint32_t opts );</dd></dl>
<dl class="section user"><dt>Description</dt><dd>This function initializes the PiP library. The PiP root process must call this. A PiP task is not required to call this function unless the PiP task calls any PiP functions. </dd></dl>
<dl class="section user"><dt>Description</dt><dd>When this function is called by a PiP root, <code>ntasks</code>, and <code>root_expp</code> are input parameters. If this is called by a PiP task, then those parameters are output returning the same values input by the root. </dd></dl>
<dl class="section user"><dt>Description</dt><dd>A PiP task may or may not call this function. If <code>pip_init</code> is not called by a PiP task explicitly, then <code>pip_init</code> is called magically and implicitly even if the PiP task program is NOT linked with the PiP library.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">pipidp</td><td>When this is called by the PiP root process, then this returns <code>PIP_PIPID_ROOT</code>, otherwise it returns the PiP ID of the calling PiP task. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ntasks</td><td>When called by the PiP root, it specifies the maximum number of PiP tasks. When called by a PiP task, then it returns the number specified by the PiP root. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">root_expp</td><td>If the root PiP is ready to export a memory region to any PiP task(s), then this parameter is to pass the exporting address. If the PiP root is not ready to export or has nothing to export then this variable can be NULL. When called by a PiP task, it returns the exported address by the PiP root, if any. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">opts</td><td>Specifying the PiP execution mode and See below.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Execution mode option</dt><dd>Users may explicitly specify the PiP execution mode. This execution mode can be categorized in two; process mode and thread mode. In the process execution mode, each PiP task may have its own file descriptors, signal handlers, and so on, just like a process. Contrastingly, in the pthread executionn mode, file descriptors and signal handlers are shared among PiP root and PiP tasks while maintaining the privatized variables. </dd></dl>
<dl class="section user"><dt></dt><dd>To spawn a PiP task in the process mode, the PiP library modifies the <b>clone()</b> flag so that the created PiP task can exhibit the alomost same way with that of normal Linux process. There are three ways implmented; using LD_PRELOAD, modifying GLIBC, and modifying GIOT entry of the <b>clone()</b> systemcall. One of the option flag values; <b>PIP_MODE_PTHREAD</b>, <b>PIP_MODE_PROCESS</b>, <b>PIP_MODE_PROCESS_PRELOAD</b>, <b>PIP_MODE_PROCESS_PIPCLONE</b>, or <b>PIP_MODE_PROCESS_GOT</b> can be specified as the option flag. Or, users may specify the execution mode by the <b>PIP_MODE</b> environment described below.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>Zero is returned if this function succeeds. Otherwise an error number is returned.</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EINVAL</td><td><em>ntasks</em> is negative </td></tr>
    <tr><td class="paramname">EBUSY</td><td>PiP root called this function twice or more without calling <a class="el" href="group__PiP-0-init-fin.html#gac4654282785abb9434ce81573fdf16ed">pip_fin</a>. </td></tr>
    <tr><td class="paramname">EPERM</td><td><em>opts</em> is invalid or unacceptable </td></tr>
    <tr><td class="paramname">EOVERFLOW</td><td><em>ntasks</em> is too large </td></tr>
    <tr><td class="paramname">ELIBSCN</td><td>verssion miss-match between PiP root and PiP task</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Environment</dt><dd><ul>
<li><b>PIP_MODE</b> Specifying the PiP execution mmode. Its value can be either <code>thread</code>, <code>pthread</code>, <code>process</code>, <code>process:preload</code>, <code>process:pipclone</code>, or <code>process:got</code>. </li>
<li><b>LD_PRELOAD</b> This is required to set appropriately to hold the path to the <code>pip_preload.so</code> file, if the PiP execution mode is <code>PIP_MODE_PROCESS_PRELOAD</code> (the <code>opts</code> in <code>pip_init</code>) and/or the PIP_MODE ennvironment is set to <code>process:preload</code>. See also the pip_mode command to set the environment variable appropriately and easily. </li>
<li><b>PIP_STACKSZ</b> Sepcifying the stack size (in bytes). The <b>KMP_STACKSIZE</b> and <b>OMP_STACKSIZE</b> are also effective. The 't', 'g', 'm', 'k' and 'b' posfix character can be used. </li>
<li><b>PIP_STOP_ON_START</b> Specifying the PIP ID to stop on start to debug the specified PiP task from the beginning. If the before hook is specified, then the PiP task will be stopped just before calling the before hook. </li>
<li><b>PIP_GDB_PATH</b> If thisenvironment is set to the path pointing to the PiP-gdb executable file, then PiP-gdb is automatically attached when an excetion signal (SIGSEGV and SIGHUP by default) is delivered. The signals which triggers the PiP-gdb invokation can be specified the <code>PIP_GDB_SIGNALS</code> environment described below. </li>
<li><b>PIP_GDB_COMMAND</b> If this PIP_GDB_COMMAND is set to a filename containing some GDB commands, then those GDB commands will be executed by the GDB in batch mode, instead of backtrace. </li>
<li><b>PIP_GDB_SIGNALS</b> Specifying the signal(s) resulting automatic PiP-gdb attach. Signal names (case insensitive) can be concatenated by the '+' or '-' symbol. 'all' is reserved to specify most of the signals. For example, 'ALL-TERM' means all signals excepting <code>SIGTERM</code>, another example, 'PIPE+INT' means <code>SIGPIPE</code> and <code>SIGINT</code>. Some signals such as SIGKILL and SIGCONT cannot be specified. </li>
<li><b>PIP_SHOW_MAPS</b> If the value is 'on' and one of the above exection signals is delivered, then the memory map will be shown. </li>
<li><b>PIP_SHOW_PIPS</b> If the value is 'on' and one of the above exection signals is delivered, then the process status by using the <code>pips</code> command (see also <a class="el" href="group__pips.html">pips</a>) will be shown.</li>
</ul>
</dd></dl>
<dl class="section user"><dt>Bugs</dt><dd>Is is NOT guaranteed that users can spawn tasks up to the number specified by the <em>ntasks</em> argument. There are some limitations come from outside of the PiP library (from GLIBC).</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__PiP-2-export.html#ga3613eaa34ad5a4985007ff9177eb6542" title="export an address of the calling PiP root or a PiP task to the others. ">pip_named_export</a> </dd>
<dd>
<a class="el" href="group__PiP-2-export.html#ga92d98dc8bafe8c73d4332d40d77be6cb" title="export an address ">pip_export</a> </dd>
<dd>
<a class="el" href="group__PiP-0-init-fin.html#gac4654282785abb9434ce81573fdf16ed">pip_fin</a> </dd>
<dd>
pip-mode </dd>
<dd>
<a class="el" href="group__pips.html" title="List or kill running PiP tasks. ">pips</a> </dd></dl>

</div>
</div>
<a class="anchor" id="gac4654282785abb9434ce81573fdf16ed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pip_fin </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section user"><dt>Name</dt><dd>pip_fin<a name="gac4654282785abb9434ce81573fdf16ed_pip_fin"></a></dd></dl>
<dl class="section user"><dt>Name</dt><dd>Finalize the PiP library</dd></dl>
<dl class="section user"><dt>Synopsis</dt><dd>#include &lt;<a class="el" href="pip_8h_source.html">pip.h</a>&gt; <br/>
int <a class="el" href="group__PiP-0-init-fin.html#gac4654282785abb9434ce81573fdf16ed">pip_fin( void )</a>;</dd></dl>
<dl class="section user"><dt>Description</dt><dd>This function finalizes the PiP library. After calling this, most of the PiP functions will return the error code <code>EPERM</code>.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>zero is returned if this function succeeds. On error, error number is returned. </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">EPERM</td><td><code>pip_init</code> is not yet called </td></tr>
    <tr><td class="paramname">EBUSY</td><td><code>one</code> or more PiP tasks are not yet terminated</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Notes</dt><dd>The behavior of calling <a class="el" href="group__PiP-0-init-fin.html#gad4e0db6c69792b3fa014e3310892a0eb">pip_init</a> after calling this <a class="el" href="group__PiP-0-init-fin.html#gac4654282785abb9434ce81573fdf16ed">pip_fin</a> is note defined and recommended to do so.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__PiP-0-init-fin.html#gad4e0db6c69792b3fa014e3310892a0eb">pip_init</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
